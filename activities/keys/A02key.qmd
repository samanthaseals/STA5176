---
title: "One Sample Means - Week 1, Lecture 2"
author: "Dr. Seals"
format: html
self-contained: true
editor: source
---

```{r setup, echo = TRUE, warning = FALSE, message = FALSE}
library(tidyverse)
library(googlesheets4)
```

**Recall the data from the abstract of research study (beginning on page 62). We examined data from 22 elementary schools located in a Florida school district in 1999. Reading and math scores from a standardized test, percent minority of the particular grade level in that school, percent in poverty of the particular grade level in that school, and total number of students in that grade at that school are included.**

```{r, echo = TRUE, message = FALSE, warning = FALSE}
data <- read_sheet("https://docs.google.com/spreadsheets/d/1cVGLLdILMI34xjnzHfJNHua6fJROJwCzUBFgV22OLT4/edit#gid=0")
```

#### 1. From last class, what are the average math and reading scores for each grade?

```{r, echo=TRUE}
data %>% 
  group_by(Grade) %>%
  summarize(Math = mean(Math, na.rm = TRUE), Reading = mean(Reading, na.rm = TRUE))
```

#### 2. Construct the 95% confidence interval for the mean math score for 3rd grade students.

```{r, echo=TRUE}
data3 <- data %>%
  filter(Grade == 3)
t.test(data3$Math)
```

The 95% CI for $\mu$ is (167.81, 175.93).

#### 3. If school districts should aim for an average greater than 165 points, how is this school district doing?

This district is doing okay -- the interval is entirely above 165.

#### 4. Use the appropriate hypothesis test to determine if the average math score for 3rd grade students is above 165 points. Test at the $\alpha$=0.05 level.

```{r, echo=TRUE}
t.test(data3$Math, mu = 165, alternative = "greater")
```

**Hypotheses**

-   $H_0: \ \mu \le 165$
-   $H_1: \ \mu > 165$

**Test Statistic**

-   $t_0 = 3.519$

***p*****-Value**

-   $p = 0.001$

**Conclusion/Interpretation**

-   Reject $H_0$ at the $\alpha=0.05$ level. There is sufficient evidence to suggest that the average math score is greater than 165.

#### 5. (Challenge!) Use `ggplot()` to graph the confidence intervals for the average reading scores for each grade.

```{r, echo=TRUE, warning = FALSE}
data4 <- data %>% filter(Grade == 4)
data5 <- data %>% filter(Grade == 5)
# t.test(data3$Reading) -- CI of 3rd grade
# point estimate 171.1045, LCL 167.7989, UCL 174.4102
# t.test(data4$Reading) -- CI of 4th grade
# point estimate 185.9591, LCL 181.4369, UCL 190.4813
#t.test(data5$Reading) -- CI of 5th grade
# point estimate 205.3632, LCL 200.0404, UCL 210.6859

Grade <- c("3", "4", "5")
PE <- c(171.1045, 185.9591, 205.3632)
LCL <- c(167.7989, 181.4369, 200.0404)
UCL <- c(174.4102, 190.4813, 210.6859)

graph <- tibble(Grade, PE, LCL, UCL)

graph %>% ggplot(aes(x=Grade, y=PE)) + 
  geom_errorbar(aes(ymin=LCL, ymax=UCL), width=.1, size=0.5) +
  geom_point(size=3) + 
  ylab("Average Reading Score") +
  xlab("Grade") +
  theme_bw()
```

