---
title: "Multiple Regression: Diagnostics - Week 10, Lecture 1"
author: "Dr. Seals"
format: html
self-contained: true
editor: source
---

**Recall the airline data from last week; we modeled revenue as a function of distance and population. The data are given here: [Google Sheet](https://docs.google.com/spreadsheets/d/10ZN0jMYdVsG2ucIJFSTquVRW916Jj-JmZIGQuqSQhy0/edit?usp=sharing).**

```{r setup, echo = TRUE, warnings = FALSE, message = FALSE}
library(tidyverse)
library(gsheet)
data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/10ZN0jMYdVsG2ucIJFSTquVRW916Jj-JmZIGQuqSQhy0/edit?usp=sharing"))
```

**1. Summarize your findings from last week. What was the resulting model, which were significant predictors of revenue (no formal hypothesis test needed - just state with appropriate evidence)? Also include the graph constructed to visualize the model.**

```{r, echo = TRUE}
m1 <- lm(Revenue ~ Distance + Population, data = data)
```

**2. Determine if there are outliers in this model. Be sure to count and list the observations that are outliers.**

```{r, echo = TRUE}
data <- data %>% mutate(outlier = abs(rstandard(m1))>2.5)
data %>% count(outlier)
data2 <- data %>% filter(outlier == TRUE)
head(data2)
```

Airport 22 is the outlier.

**3. Determine if there are any influence and leverage points in this model. Be sure to count and list the observations that are considered influential and leverage.**

```{r, echo = TRUE}
library(lindia)
gg_cooksd(m1) + theme_bw()
```

Airports 20 and 22 are influential/leverage points.

**4. Is there evidence of multicollinearity?**

```{r, echo = TRUE}
library(car)
vif(m1)
```

No, multicollinearity is not present.

**5. Perform a sensitivity analysis: remove the data points identified as potential offenders in Q2 and Q3 and reconstruct the model. Be sure to state the resulting model.**

```{r, echo = TRUE}
data3 <- data %>% filter(!Airport %in% c(20, 22))
tail(data3, n=3)
```

We eliminated airports 20 and 22.

```{r, echo = TRUE}
m2 <- lm(Revenue ~ Distance + Population, data = data3)
summary(m2)
```

$$\hat{\text{revenue}} = 99.91 +  0.48 \text{ distance} + 0.89 \text{ population}$$

**6. Using the model in Q5, are there any significant predictors of revenue?**

Yes, both distance and population are significant predictors of revenue (*p* = 0.003 and *p* = 0.029, respectively).

**7. Reconstruct the data visualization from last week, but using the new model's results.**

**8. Put the graphs from last week and Q7 side by side (hint: use `ggpubr`).**

**9. Compare and contrast the modeling results and the graphs that are side by side in Q8.**

**10. Why do you think I assigned this particular dataset for analysis? What are you taking away from this assignment?**