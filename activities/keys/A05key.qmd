---
title: "Wilcoxons - Week 3, Lecture 1"
author: "Dr. Seals"
format: html
self-contained: true
editor: source
---

```{r setup, echo = TRUE, warnings = FALSE, message = FALSE}
library(tidyverse)
library(gsheet)
library(ggpubr)
```

## Question 1:

**Recall the first dataset from last week. A large credit union awards quarterly bonuses to its employees. To ensure fairness across departments, data on the bonuses are regularly reviewed for equality. Consider the data in the following Google Sheet, which includes the bonus percentage for each employee in two departments.**

```{r, echo = TRUE}
data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/1q0Ouhr6hGBDp-5oyQuYGcsWTLrsayywVHJS7o17Sm6Y/edit?usp=sharing"))
```

#### a. (From last week!) Use the appropriate *t*-test to determine if the two departments are given different bonus amounts. Test at the &alpha;=0.01 level.

```{r, echo=TRUE}
t.test(Bonus ~ Department, data = data)
```

**Hypotheses**

-   $H_0: \ \mu_{\text{C}} = \mu_{\text{M}}$
-   $H_1: \ \mu_{\text{C}} \ne \mu_{\text{M}}$

**Test Statistic**

-   $t_0 = 3.901$

***p*****-Value**

-   $p < 0.001$

**Conclusion/Interpretation**

-   Reject $H_0$ at the $\alpha=0.01$ level. There is sufficient evidence to suggest that there is a difference in the bonus percentage when comparing the credit and mortgage departments.

#### b. Use the appropriate nonparametric test to determine if the two departments are given different bonus amounts. Test at the &alpha;=0.01 level.

```{r, echo = TRUE}
wilcox.test(Bonus ~ Department, data = data, exact = FALSE)
```

**Hypotheses**

-   $H_0: \ M_{\text{C}} = M_{\text{M}}$
-   $H_1: \ M_{\text{C}} \ne M_{\text{M}}$

**Test Statistic**

-   $T_0 = 683$

***p*****-Value**

-   $p < 0.001$

**Conclusion/Interpretation**

-   Reject $H_0$ at the $\alpha=0.01$ level. There is sufficient evidence to suggest that there is a difference in the bonus percentage when comparing the credit and mortgage departments.

#### c. Assess the assumption(s) associated with the *t*-test in part a. In your assessment, determine if the *t*-test or the corresponding nonparametric test should be reported.

```{r, echo = TRUE}
C <- data %>% 
  filter(Department == "Credit") %>% 
  ggplot(aes(sample = Bonus)) +
    stat_qq(size=3) +
    stat_qq_line() +
    theme_minimal() +
    xlab("Theoretical") +
    ylab("Sample") +
    ggtitle("Credit")

M <- data %>% 
  filter(Department == "Mortgage")  %>% 
  ggplot(aes(sample = Bonus)) +
    stat_qq(size=3) +
    stat_qq_line() +
    theme_minimal() +
    xlab("Theoretical") +
    ylab("Sample") +
    ggtitle("Mortgage")

ggarrange(C, M, ncol=2, nrow=1)
```

#### d. Write a brief paragraph explaining your findings to management, based on the test chosen in part c.

## Question 2: 

**Recall the second dataset from last week. A new 2 hour reading comprehension program has been developed by a local tutoring center. A pilot study of 30 students has been conducted and we have data on a reading comprehension test taken before the program and a separate reading comprehension test taken after the program. Consider the data, found in the following Google Sheet.**

```{r, echo = TRUE}
data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/1ijxX7c6qcFAw-r_mNSxC-Ps5b5njw-WtE4RcxPTySXU/edit?usp=sharing"))
```

#### a. (From last week!) Use the appropriate *t*-test to determine if the program raises comprehension test averages by at least 5 points. Test at the &alpha;=0.05 level.

```{r, echo=TRUE}
t.test(data$Post, data$Pre, mu = 5, alternative = "greater", paired = TRUE)
```

**Hypotheses**

-   $H_0: \ \mu_{\text{Post}} \le \mu_{\text{Pre}}$
-   $H_1: \ \mu_{\text{Post}} > \mu_{\text{Pre}}$

**Test Statistic**

-   $t_0 = -1.563$

***p*****-Value**

-   $p = 0.9356$

**Conclusion/Interpretation**

-   Fail to reject $H_0$ at the $\alpha=0.05$ level. There is not sufficient evidence to suggest that the reading program is increasing scores by 5 points or more.

#### b. Use the appropriate nonparametric test to determine if the program raises comprehension test averages by at least 5 points. Test at the &alpha;=0.05 level.

```{r, echo=TRUE}
wilcox.test(data$Post, data$Pre, paired = TRUE, mu = 5, alternative = "greater", exact = FALSE)
```

**Hypotheses**

-   $H_0: \ M_{\text{Post}} \le M_{\text{Pre}}$
-   $H_1: \ M_{\text{Post}} > M_{\text{Pre}}$

**Test Statistic**

-   $T_0 = 124.5$

***p*****-Value**

-   $p = 0.906$

**Conclusion/Interpretation**

-   Fail to reject $H_0$ at the $\alpha=0.05$ level. There is not sufficient evidence to suggest that the reading program is increasing scores by 5 points or more.

#### c. Assess the assumption(s) associated with the *t*-test in part a. In your assessment, determine if the *t*-test or the corresponding nonparametric test should be reported.

```{r, echo = TRUE}
data %>% 
  mutate(d = Post-Pre) %>%
  ggplot(aes(sample = d)) +
    stat_qq(size=3) +
    stat_qq_line() +
    theme_minimal() +
    xlab("Theoretical") +
    ylab("Sample") 
```

#### d. Write a brief paragraph explaining your findings to the tutoring center, based on the test chosen in part c.










